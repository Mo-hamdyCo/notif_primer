[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-07-13 14:52:36.512066",
  "module": "Crm Primer",
  "name": "Activity",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Event",
  "script": "customer = None\r\n\r\n# لف على المشاركين event_participants عشان تلاقي لو في Customer\r\nfor ref in doc.event_participants or []:\r\n    if ref.reference_doctype == \"Customer\":\r\n        customer = ref.reference_docname\r\n        break\r\n\r\n# تسجيل للتشخيص\r\nfrappe.log_error(f\"Customer found: {customer}\", \"Event Trigger Debug\")\r\n\r\nparticipants = [d.owner for d in doc.event_participants if d.owner] if doc.event_participants else []\r\n\r\nfrappe.get_doc({\r\n    \"doctype\": \"Task\",\r\n    \"subject\": f\"Follow-up: {doc.subject}\",\r\n    \"status\": \"Open\",\r\n    \"reference_type\": \"Customer\" if customer else \"Event\",\r\n    \"reference_name\": customer if customer else doc.name,\r\n    \"description\": doc.description or \"\",\r\n    \"expected_start_date\": doc.starts_on,\r\n    \"expected_end_date\": doc.ends_on,\r\n    \"assigned_to\": participants or [doc.owner]\r\n}).insert()\r\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-08-02 12:55:16.855923",
  "module": "Notification Primer",
  "name": "Calculate Diif Time Attendace",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Attendance",
  "script": "if doc.status == \"Present\" and doc.working_hours is not None and doc.custom_shift_working_hour is not None:\r\n    doc.custom_different_hours = doc.working_hours - doc.custom_shift_working_hour\r\nelse:\r\n    doc.custom_different_hours = 0",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-08-03 12:36:20.762450",
  "module": "Posnext",
  "name": "Sales Invoice Return",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "# إذا كانت فاتورة المرتجع (Credit Note)\r\nif doc.is_return:\r\n    doc.status = \"Return\"\r\n# وإلا لو تم حفظها/إرسالها عادي\r\nelif doc.docstatus == 1:\r\n    doc.status = \"Submitted\"\r\n",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-08-03 12:38:52.343736",
  "module": "Posnext",
  "name": "POS Invoice",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "POS Invoice",
  "script": "# POS Invoice Status Automation\r\n# إذا كانت فاتورة مرتجع\r\nif doc.is_return:\r\n    doc.status = \"Return\"\r\n\r\n# وإلا إذا هي فاتورة POS (بيع مباشر) وتم إرسالها\r\nelif doc.is_pos and doc.docstatus == 1:\r\n    doc.status = \"Paid\"\r\n\r\n# وإلا، لو تم إغلاق الدرج (Consolidation)\r\nelif doc.docstatus == 1:\r\n    doc.status = \"Consolidated\"\r\n",
  "script_type": "DocType Event"
 }
]